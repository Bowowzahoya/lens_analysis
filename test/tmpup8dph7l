# -*- coding: utf-8 -*-
"""
Created on Mon Mar  1 13:30:01 2021

@author: David
"""

import unittest
from context import lens_analysis
from lens_analysis import applicants as ap
import pandas as pd

FOLD = "res/"

class TestMerge(unittest.TestCase):
    @classmethod
    def setUpClass(cls):
        cls.fam = pd.read_excel(FOLD+"fam_mcov.xlsx")
        print(cls.fam)

    def testMergeToApplicants(self):
        apps = ap.merge_to_applicants(self.fam)
        print(apps)
        
        apps.to_excel("apps.xlsx")
        
    @unittest.skip
    def testGetAllApps(self):
        apps = ap._get_all_apps(self.fam[ap.APP_COL])
        assert apps['WINDWISDEM CORP'] == [995]
        

class TestAlias(unittest.TestCase):
    @classmethod
    def setUpClass(cls):
        cls.fam = pd.read_excel(FOLD+"fam_mcov.xlsx")
        cls.alias = {"DJI":["SZ DJI TECHNOLOGY CO LTD",
                            "エスゼット ディージェイアイ テクノロジー カンパニー リミテッドＳＺ ＤＪＩ ＴＥＣＨＮＯＬＯＧＹ ＣＯ．，ＬＴＤ",
                            "DJI-INNOVATIONS"]}
        print(cls.fam)

    def testAliasSingleApps(self):
        apps = "SZ DJI TECHNOLOGY CO LTD;;エスゼット ディージェイアイ テクノロジー カンパニー リミテッドＳＺ ＤＪＩ ＴＥＣＨＮＯＬＯＧＹ ＣＯ．，ＬＴＤ"
        apps = _alias_single_apps(apps, alias_d)
        
        apps.to_excel("apps.xlsx")
        
    @unittest.skip
    def testGetAllApps(self):
        apps = ap._get_all_apps(self.fam[ap.APP_COL])
        assert apps['WINDWISDEM CORP'] == [995]
        
        
        
    
    
if __name__ == '__main__':
    unittest.main()